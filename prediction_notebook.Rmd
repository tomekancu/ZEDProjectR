---
title: "ZED Project"
output: html_notebook
---


Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 


Load data
```{r}
data = read.table('data/breast-cancer.data', sep=',', header = F, col.names = c('Class', 'age', 'menopause', 'tumor-size', 'inv-nodes', 'node-caps', 'deg-malig', 'breast', 'breast-quad' ,'irradiat'))

```


Load libraries
```{r}
library(randomForest)
require(caTools)
```


Check data summary
```{r}
summary(data)
```
Check data dimensions
```{r}
dim(data)
```
Check data NA values
```{r}
colSums(is.na(data))
```
Check data column classes
```{r}
sapply(data, class)
```

Load libraries
```{r}
library(randomForest)
require(caTools)
```

Split data into train and test subsets
```{r}
sample = sample.split(data$Class   , SplitRatio = .75)
train = subset(data, sample == TRUE)
test  = subset(data, sample == FALSE)
dim(train)
dim(test)
```


Split data into train and test subsets
```{r}
rf <- randomForest(
  Class ~ .,
  data=train
)
```


Apply model to test set
```{r}
pred = predict(rf, newdata=test[-1])
```

Print confusion matrix
```{r}
cm = table(test[,1], pred)
cm
```

Draw confusion matrix
```{r}
fourfoldplot(cm, color = c("#CC6666", "#99CC99"),
             conf.level = 0, margin = 1, main = "Confusion Matrix")
```

Accuracy
```{r}
accuracy = (cm[2,2] + cm[1,1]) / sum(cm)
accuracy
```

Precision
```{r}
precision = cm[2,2] / (cm[2,2] + cm[1,2])
precision
```

Recall
```{r}
recall = cm[2,2] / (cm[2,2] + cm[2,1])
recall
```





